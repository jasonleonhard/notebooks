<iframe src="http://nbviewer.jupyter.org/github/jasonleonhard/notebooks/blob/master/sklearn.html"></iframe>


```python
![alt text](http://nbviewer.jupyter.org/github/jasonleonhard/notebooks/blob/master/sklearn.html "viewer")

[http://nbviewer.jupyter.org/github/jasonleonhard/notebooks/blob/master/sklearn.html](http://nbviewer.jupyter.org/github/jasonleonhard/notebooks/blob/master/sklearn.html)
```


```python
# A linear regression line y = mx + b
# can be used to find the relationship between X and Y
```


```python
# import libs
from sklearn import datasets, linear_model
import numpy as np
```


```python
# load data
diabetes = datasets.load_diabetes()
type(diabetes)
diabetes
```




    {'data': array([[ 0.03807591,  0.05068012,  0.06169621, ..., -0.00259226,
              0.01990842, -0.01764613],
            [-0.00188202, -0.04464164, -0.05147406, ..., -0.03949338,
             -0.06832974, -0.09220405],
            [ 0.08529891,  0.05068012,  0.04445121, ..., -0.00259226,
              0.00286377, -0.02593034],
            ...,
            [ 0.04170844,  0.05068012, -0.01590626, ..., -0.01107952,
             -0.04687948,  0.01549073],
            [-0.04547248, -0.04464164,  0.03906215, ...,  0.02655962,
              0.04452837, -0.02593034],
            [-0.04547248, -0.04464164, -0.0730303 , ..., -0.03949338,
             -0.00421986,  0.00306441]]),
     'target': array([ 151.,   75.,  141.,  206.,  135.,   97.,  138.,   63.,  110.,
             310.,  101.,   69.,  179.,  185.,  118.,  171.,  166.,  144.,
              97.,  168.,   68.,   49.,   68.,  245.,  184.,  202.,  137.,
              85.,  131.,  283.,  129.,   59.,  341.,   87.,   65.,  102.,
             265.,  276.,  252.,   90.,  100.,   55.,   61.,   92.,  259.,
              53.,  190.,  142.,   75.,  142.,  155.,  225.,   59.,  104.,
             182.,  128.,   52.,   37.,  170.,  170.,   61.,  144.,   52.,
             128.,   71.,  163.,  150.,   97.,  160.,  178.,   48.,  270.,
             202.,  111.,   85.,   42.,  170.,  200.,  252.,  113.,  143.,
              51.,   52.,  210.,   65.,  141.,   55.,  134.,   42.,  111.,
              98.,  164.,   48.,   96.,   90.,  162.,  150.,  279.,   92.,
              83.,  128.,  102.,  302.,  198.,   95.,   53.,  134.,  144.,
             232.,   81.,  104.,   59.,  246.,  297.,  258.,  229.,  275.,
             281.,  179.,  200.,  200.,  173.,  180.,   84.,  121.,  161.,
              99.,  109.,  115.,  268.,  274.,  158.,  107.,   83.,  103.,
             272.,   85.,  280.,  336.,  281.,  118.,  317.,  235.,   60.,
             174.,  259.,  178.,  128.,   96.,  126.,  288.,   88.,  292.,
              71.,  197.,  186.,   25.,   84.,   96.,  195.,   53.,  217.,
             172.,  131.,  214.,   59.,   70.,  220.,  268.,  152.,   47.,
              74.,  295.,  101.,  151.,  127.,  237.,  225.,   81.,  151.,
             107.,   64.,  138.,  185.,  265.,  101.,  137.,  143.,  141.,
              79.,  292.,  178.,   91.,  116.,   86.,  122.,   72.,  129.,
             142.,   90.,  158.,   39.,  196.,  222.,  277.,   99.,  196.,
             202.,  155.,   77.,  191.,   70.,   73.,   49.,   65.,  263.,
             248.,  296.,  214.,  185.,   78.,   93.,  252.,  150.,   77.,
             208.,   77.,  108.,  160.,   53.,  220.,  154.,  259.,   90.,
             246.,  124.,   67.,   72.,  257.,  262.,  275.,  177.,   71.,
              47.,  187.,  125.,   78.,   51.,  258.,  215.,  303.,  243.,
              91.,  150.,  310.,  153.,  346.,   63.,   89.,   50.,   39.,
             103.,  308.,  116.,  145.,   74.,   45.,  115.,  264.,   87.,
             202.,  127.,  182.,  241.,   66.,   94.,  283.,   64.,  102.,
             200.,  265.,   94.,  230.,  181.,  156.,  233.,   60.,  219.,
              80.,   68.,  332.,  248.,   84.,  200.,   55.,   85.,   89.,
              31.,  129.,   83.,  275.,   65.,  198.,  236.,  253.,  124.,
              44.,  172.,  114.,  142.,  109.,  180.,  144.,  163.,  147.,
              97.,  220.,  190.,  109.,  191.,  122.,  230.,  242.,  248.,
             249.,  192.,  131.,  237.,   78.,  135.,  244.,  199.,  270.,
             164.,   72.,   96.,  306.,   91.,  214.,   95.,  216.,  263.,
             178.,  113.,  200.,  139.,  139.,   88.,  148.,   88.,  243.,
              71.,   77.,  109.,  272.,   60.,   54.,  221.,   90.,  311.,
             281.,  182.,  321.,   58.,  262.,  206.,  233.,  242.,  123.,
             167.,   63.,  197.,   71.,  168.,  140.,  217.,  121.,  235.,
             245.,   40.,   52.,  104.,  132.,   88.,   69.,  219.,   72.,
             201.,  110.,   51.,  277.,   63.,  118.,   69.,  273.,  258.,
              43.,  198.,  242.,  232.,  175.,   93.,  168.,  275.,  293.,
             281.,   72.,  140.,  189.,  181.,  209.,  136.,  261.,  113.,
             131.,  174.,  257.,   55.,   84.,   42.,  146.,  212.,  233.,
              91.,  111.,  152.,  120.,   67.,  310.,   94.,  183.,   66.,
             173.,   72.,   49.,   64.,   48.,  178.,  104.,  132.,  220.,   57.])}




```python
# use only one feature
diabetes_X = diabetes.data[:, np.newaxis, 2]
diabetes_X_train = diabetes_X[:-20]
diabetes_X_test = diabetes_X[:-20]
diabetes_X_train
diabetes_X_test
```




    array([[ 0.06169621],
           [-0.05147406],
           [ 0.04445121],
           [-0.01159501],
           [-0.03638469],
           [-0.04069594],
           [-0.04716281],
           [-0.00189471],
           [ 0.06169621],
           [ 0.03906215],
           [-0.08380842],
           [ 0.01750591],
           [-0.02884001],
           [-0.00189471],
           [-0.02560657],
           [-0.01806189],
           [ 0.04229559],
           [ 0.01211685],
           [-0.0105172 ],
           [-0.01806189],
           [-0.05686312],
           [-0.02237314],
           [-0.00405033],
           [ 0.06061839],
           [ 0.03582872],
           [-0.01267283],
           [-0.07734155],
           [ 0.05954058],
           [-0.02129532],
           [-0.00620595],
           [ 0.04445121],
           [-0.06548562],
           [ 0.12528712],
           [-0.05039625],
           [-0.06332999],
           [-0.03099563],
           [ 0.02289497],
           [ 0.01103904],
           [ 0.07139652],
           [ 0.01427248],
           [-0.00836158],
           [-0.06764124],
           [-0.0105172 ],
           [-0.02345095],
           [ 0.06816308],
           [-0.03530688],
           [-0.01159501],
           [-0.0730303 ],
           [-0.04177375],
           [ 0.01427248],
           [-0.00728377],
           [ 0.0164281 ],
           [-0.00943939],
           [-0.01590626],
           [ 0.0250506 ],
           [-0.04931844],
           [ 0.04121778],
           [-0.06332999],
           [-0.06440781],
           [-0.02560657],
           [-0.00405033],
           [ 0.00457217],
           [-0.00728377],
           [-0.0374625 ],
           [-0.02560657],
           [-0.02452876],
           [-0.01806189],
           [-0.01482845],
           [-0.02991782],
           [-0.046085  ],
           [-0.06979687],
           [ 0.03367309],
           [-0.00405033],
           [-0.02021751],
           [ 0.00241654],
           [-0.03099563],
           [ 0.02828403],
           [-0.03638469],
           [-0.05794093],
           [-0.0374625 ],
           [ 0.01211685],
           [-0.02237314],
           [-0.03530688],
           [ 0.00996123],
           [-0.03961813],
           [ 0.07139652],
           [-0.07518593],
           [-0.00620595],
           [-0.04069594],
           [-0.04824063],
           [-0.02560657],
           [ 0.0519959 ],
           [ 0.00457217],
           [-0.06440781],
           [-0.01698407],
           [-0.05794093],
           [ 0.00996123],
           [ 0.08864151],
           [-0.00512814],
           [-0.06440781],
           [ 0.01750591],
           [-0.04500719],
           [ 0.02828403],
           [ 0.04121778],
           [ 0.06492964],
           [-0.03207344],
           [-0.07626374],
           [ 0.04984027],
           [ 0.04552903],
           [-0.00943939],
           [-0.03207344],
           [ 0.00457217],
           [ 0.02073935],
           [ 0.01427248],
           [ 0.11019775],
           [ 0.00133873],
           [ 0.05846277],
           [-0.02129532],
           [-0.0105172 ],
           [-0.04716281],
           [ 0.00457217],
           [ 0.01750591],
           [ 0.08109682],
           [ 0.0347509 ],
           [ 0.02397278],
           [-0.00836158],
           [-0.06117437],
           [-0.00189471],
           [-0.06225218],
           [ 0.0164281 ],
           [ 0.09618619],
           [-0.06979687],
           [-0.02129532],
           [-0.05362969],
           [ 0.0433734 ],
           [ 0.05630715],
           [-0.0816528 ],
           [ 0.04984027],
           [ 0.11127556],
           [ 0.06169621],
           [ 0.01427248],
           [ 0.04768465],
           [ 0.01211685],
           [ 0.00564998],
           [ 0.04660684],
           [ 0.12852056],
           [ 0.05954058],
           [ 0.09295276],
           [ 0.01535029],
           [-0.00512814],
           [ 0.0703187 ],
           [-0.00405033],
           [-0.00081689],
           [-0.04392938],
           [ 0.02073935],
           [ 0.06061839],
           [-0.0105172 ],
           [-0.03315126],
           [-0.06548562],
           [ 0.0433734 ],
           [-0.06225218],
           [ 0.06385183],
           [ 0.03043966],
           [ 0.07247433],
           [-0.0191397 ],
           [-0.06656343],
           [-0.06009656],
           [ 0.06924089],
           [ 0.05954058],
           [-0.02668438],
           [-0.02021751],
           [-0.046085  ],
           [ 0.07139652],
           [-0.07949718],
           [ 0.00996123],
           [-0.03854032],
           [ 0.01966154],
           [ 0.02720622],
           [-0.00836158],
           [-0.01590626],
           [ 0.00457217],
           [-0.04285156],
           [ 0.00564998],
           [-0.03530688],
           [ 0.02397278],
           [-0.01806189],
           [ 0.04229559],
           [-0.0547075 ],
           [-0.00297252],
           [-0.06656343],
           [-0.01267283],
           [-0.04177375],
           [-0.03099563],
           [-0.00512814],
           [-0.05901875],
           [ 0.0250506 ],
           [-0.046085  ],
           [ 0.00349435],
           [ 0.05415152],
           [-0.04500719],
           [-0.05794093],
           [-0.05578531],
           [ 0.00133873],
           [ 0.03043966],
           [ 0.00672779],
           [ 0.04660684],
           [ 0.02612841],
           [ 0.04552903],
           [ 0.04013997],
           [-0.01806189],
           [ 0.01427248],
           [ 0.03690653],
           [ 0.00349435],
           [-0.07087468],
           [-0.03315126],
           [ 0.09403057],
           [ 0.03582872],
           [ 0.03151747],
           [-0.06548562],
           [-0.04177375],
           [-0.03961813],
           [-0.03854032],
           [-0.02560657],
           [-0.02345095],
           [-0.06656343],
           [ 0.03259528],
           [-0.046085  ],
           [-0.02991782],
           [-0.01267283],
           [-0.01590626],
           [ 0.07139652],
           [-0.03099563],
           [ 0.00026092],
           [ 0.03690653],
           [ 0.03906215],
           [-0.01482845],
           [ 0.00672779],
           [-0.06871905],
           [-0.00943939],
           [ 0.01966154],
           [ 0.07462995],
           [-0.00836158],
           [-0.02345095],
           [-0.046085  ],
           [ 0.05415152],
           [-0.03530688],
           [-0.03207344],
           [-0.0816528 ],
           [ 0.04768465],
           [ 0.06061839],
           [ 0.05630715],
           [ 0.09834182],
           [ 0.05954058],
           [ 0.03367309],
           [ 0.05630715],
           [-0.06548562],
           [ 0.16085492],
           [-0.05578531],
           [-0.02452876],
           [-0.03638469],
           [-0.00836158],
           [-0.04177375],
           [ 0.12744274],
           [-0.07734155],
           [ 0.02828403],
           [-0.02560657],
           [-0.06225218],
           [-0.00081689],
           [ 0.08864151],
           [-0.03207344],
           [ 0.03043966],
           [ 0.00888341],
           [ 0.00672779],
           [-0.02021751],
           [-0.02452876],
           [-0.01159501],
           [ 0.02612841],
           [-0.05901875],
           [-0.03638469],
           [-0.02452876],
           [ 0.01858372],
           [-0.0902753 ],
           [-0.00512814],
           [-0.05255187],
           [-0.02237314],
           [-0.02021751],
           [-0.0547075 ],
           [-0.00620595],
           [-0.01698407],
           [ 0.05522933],
           [ 0.07678558],
           [ 0.01858372],
           [-0.02237314],
           [ 0.09295276],
           [-0.03099563],
           [ 0.03906215],
           [-0.06117437],
           [-0.00836158],
           [-0.0374625 ],
           [-0.01375064],
           [ 0.07355214],
           [-0.02452876],
           [ 0.03367309],
           [ 0.0347509 ],
           [-0.03854032],
           [-0.03961813],
           [-0.00189471],
           [-0.03099563],
           [-0.046085  ],
           [ 0.00133873],
           [ 0.06492964],
           [ 0.04013997],
           [-0.02345095],
           [ 0.05307371],
           [ 0.04013997],
           [-0.02021751],
           [ 0.01427248],
           [-0.03422907],
           [ 0.00672779],
           [ 0.00457217],
           [ 0.03043966],
           [ 0.0519959 ],
           [ 0.06169621],
           [-0.00728377],
           [ 0.00564998],
           [ 0.05415152],
           [-0.00836158],
           [ 0.114509  ],
           [ 0.06708527],
           [-0.05578531],
           [ 0.03043966],
           [-0.02560657],
           [ 0.10480869],
           [-0.00620595],
           [-0.04716281],
           [-0.04824063],
           [ 0.08540807],
           [-0.01267283],
           [-0.03315126],
           [-0.00728377],
           [-0.01375064],
           [ 0.05954058],
           [ 0.02181716],
           [ 0.01858372],
           [-0.01159501],
           [-0.00297252],
           [ 0.01750591],
           [-0.02991782],
           [-0.02021751],
           [-0.05794093],
           [ 0.06061839],
           [-0.04069594],
           [-0.07195249],
           [-0.05578531],
           [ 0.04552903],
           [-0.00943939],
           [-0.03315126],
           [ 0.04984027],
           [-0.08488624],
           [ 0.00564998],
           [ 0.02073935],
           [-0.00728377],
           [ 0.10480869],
           [-0.02452876],
           [-0.00620595],
           [-0.03854032],
           [ 0.13714305],
           [ 0.17055523],
           [ 0.00241654],
           [ 0.03798434],
           [-0.05794093],
           [-0.00943939],
           [-0.02345095],
           [-0.0105172 ],
           [-0.03422907],
           [-0.00297252],
           [ 0.06816308],
           [ 0.00996123],
           [ 0.00241654],
           [-0.03854032],
           [ 0.02612841],
           [-0.08919748],
           [ 0.06061839],
           [-0.02884001],
           [-0.02991782],
           [-0.0191397 ],
           [-0.04069594],
           [ 0.01535029],
           [-0.02452876],
           [ 0.00133873],
           [ 0.06924089],
           [-0.06979687],
           [-0.02991782],
           [-0.046085  ],
           [ 0.01858372],
           [ 0.00133873],
           [-0.03099563],
           [-0.00405033],
           [ 0.01535029],
           [ 0.02289497],
           [ 0.04552903],
           [-0.04500719],
           [-0.03315126],
           [ 0.097264  ],
           [ 0.05415152],
           [ 0.12313149],
           [-0.08057499],
           [ 0.09295276],
           [-0.05039625],
           [-0.01159501],
           [-0.0277622 ],
           [ 0.05846277],
           [ 0.08540807],
           [-0.00081689],
           [ 0.00672779],
           [ 0.00888341],
           [ 0.08001901],
           [ 0.07139652],
           [-0.02452876],
           [-0.0547075 ],
           [-0.03638469],
           [ 0.0164281 ]])




```python
# split targets into training and test sets
diabetes_Y_train = diabetes.target[:-20]
diabetes_Y_test  = diabetes.target[-20:]
diabetes_Y_train
diabetes_Y_test
```




    array([ 233.,   91.,  111.,  152.,  120.,   67.,  310.,   94.,  183.,
             66.,  173.,   72.,   49.,   64.,   48.,  178.,  104.,  132.,
            220.,   57.])




```python
# linear regresson
regr = linear_model.LinearRegression()
regr
```




    LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)




```python
# train model using training sets
regr.fit(diabetes_X_train, diabetes_Y_train)
regr
```




    LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)
